services:
    php-cli:
        build: docker/php-cli
        container_name: 'strava-statistics-php-cli'
        volumes:
            - './:/var/www/'
        working_dir: /var/www
        profiles:
            - on-demand
        networks:
            - app_network
    app:
        build:
            context: ./
            dockerfile: docker/app/Dockerfile
        container_name: 'strava-statistics-app'
        volumes:
            - ./storage:/var/www/storage
        environment:
            ATHLETE_BIRTHDAY: ${ATHLETE_BIRTHDAY}
            STRAVA_CLIENT_ID: ${STRAVA_CLIENT_ID}
            STRAVA_CLIENT_SECRET: ${STRAVA_CLIENT_SECRET}
            STRAVA_REFRESH_TOKEN: ${STRAVA_REFRESH_TOKEN}
        ports:
            - '8081:8080'
        networks:
            - app_network
networks:
    app_network: {}
